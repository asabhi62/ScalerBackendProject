<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/ProjectApplication.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/ProjectApplication.java" />
              <option name="originalContent" value="package com.learning.project;&#10;&#10;import com.zaxxer.hikari.HikariDataSource;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.boot.SpringApplication;&#10;import org.springframework.boot.autoconfigure.SpringBootApplication;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;&#10;import javax.sql.DataSource;&#10;&#10;@SpringBootApplication&#10;public class ProjectApplication {&#10;&#10;&#9;public static void main(String[] args) {&#10;&#9;&#9;SpringApplication.run(ProjectApplication.class, args);&#10;&#9;}&#10;&#10;&#9;@Bean&#10;&#9;public DataSource dataSource(&#10;&#9;&#9;&#9;@Value(&quot;${spring.datasource.url}&quot;) String url,&#10;&#9;&#9;&#9;@Value(&quot;${spring.datasource.username}&quot;) String username,&#10;&#9;&#9;&#9;@Value(&quot;${spring.datasource.password}&quot;) String password&#10;&#9;) {&#10;&#9;&#9;HikariDataSource dataSource = new HikariDataSource();&#10;&#9;&#9;dataSource.setJdbcUrl(url);&#10;&#9;&#9;dataSource.setUsername(username);&#10;&#9;&#9;dataSource.setPassword(password);&#10;&#9;&#9;// Optional: tune pool size and other properties&#10;&#9;&#9;dataSource.setMaximumPoolSize(10);&#10;&#9;&#9;dataSource.setMinimumIdle(2);&#10;&#9;&#9;dataSource.setPoolName(&quot;ProjectHikariCP&quot;);&#10;&#9;&#9;return dataSource;&#10;&#9;}&#10;    @Bean&#10;    public PasswordEncoder passwordEncoder() {&#10;        return new BCryptPasswordEncoder();&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend;&#10;&#10;import com.zaxxer.hikari.HikariDataSource;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.boot.SpringApplication;&#10;import org.springframework.boot.autoconfigure.SpringBootApplication;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;&#10;import javax.sql.DataSource;&#10;&#10;@SpringBootApplication&#10;public class ProjectApplication {&#10;&#10;&#9;public static void main(String[] args) {&#10;&#9;&#9;SpringApplication.run(ProjectApplication.class, args);&#10;&#9;}&#10;&#10;&#9;@Bean&#10;&#9;public DataSource dataSource(&#10;&#9;&#9;&#9;@Value(&quot;${spring.datasource.url}&quot;) String url,&#10;&#9;&#9;&#9;@Value(&quot;${spring.datasource.username}&quot;) String username,&#10;&#9;&#9;&#9;@Value(&quot;${spring.datasource.password}&quot;) String password&#10;&#9;) {&#10;&#9;&#9;HikariDataSource dataSource = new HikariDataSource();&#10;&#9;&#9;dataSource.setJdbcUrl(url);&#10;&#9;&#9;dataSource.setUsername(username);&#10;&#9;&#9;dataSource.setPassword(password);&#10;&#9;&#9;// Optional: tune pool size and other properties&#10;&#9;&#9;dataSource.setMaximumPoolSize(10);&#10;&#9;&#9;dataSource.setMinimumIdle(2);&#10;&#9;&#9;dataSource.setPoolName(&quot;ProjectHikariCP&quot;);&#10;&#9;&#9;return dataSource;&#10;&#9;}&#10;    @Bean&#10;    public PasswordEncoder passwordEncoder() {&#10;        return new BCryptPasswordEncoder();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/controllers/AuthenticationController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/controllers/AuthenticationController.java" />
              <option name="originalContent" value="package com.learning.project.authentication.controllers;&#10;&#10;import com.learning.project.authentication.models.UserInfo;&#10;import com.learning.project.authentication.services.AuthenticationService;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.http.HttpStatus;&#10;&#10;import jakarta.servlet.http.HttpServletResponse;&#10;import jakarta.servlet.http.Cookie;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/auth&quot;)&#10;public class AuthenticationController {&#10;&#10;    @Autowired&#10;    private AuthenticationService authenticationService;&#10;&#10;    @PutMapping(&quot;/signup&quot;)&#10;    public ResponseEntity&lt;String&gt; signup(@RequestBody UserInfo userInfo) {&#10;        try {&#10;            authenticationService.signup(userInfo);&#10;            return ResponseEntity.status(HttpStatus.CREATED).body(&quot;Signup successful&quot;);&#10;        } catch (IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(e.getMessage());&#10;        } catch (Exception e) {&#10;            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(e.getMessage()+&quot;\nSignup failed&quot;);&#10;        }&#10;    }&#10;&#10;    @PostMapping(&quot;/login&quot;)&#10;    public ResponseEntity&lt;String&gt; login(@RequestBody UserInfo userInfo, HttpServletResponse response) {&#10;        try {&#10;            String token = authenticationService.login(userInfo);&#10;            response.setHeader(&quot;Authorization&quot;, &quot;Bearer &quot; + token);&#10;            Cookie cookie = new Cookie(&quot;token&quot;, token);&#10;            cookie.setHttpOnly(true);&#10;            cookie.setPath(&quot;/&quot;);&#10;            // Uncomment the next line if your app uses HTTPS&#10;            // cookie.setSecure(true);&#10;            response.addCookie(cookie);&#10;            return ResponseEntity.ok(&quot;Login successful&quot;);&#10;        } catch (SecurityException | IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(e.getMessage());&#10;        } catch (Exception e) {&#10;            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(&quot;Login failed&quot;);&#10;        }&#10;    }&#10;&#10;    @GetMapping(&quot;/getUserDetails&quot;)&#10;    public ResponseEntity&lt;String&gt; getUserDetails(HttpServletRequest request) {&#10;        try {&#10;            String token = null;&#10;            Cookie[] cookies = request.getCookies();&#10;            if (cookies != null) {&#10;                for (Cookie cookie : cookies) {&#10;                    if (&quot;token&quot;.equals(cookie.getName())) {&#10;                        token = cookie.getValue();&#10;                        break;&#10;                    }&#10;                }&#10;            }&#10;            if (token == null || token.isEmpty()) {&#10;                return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(&quot;Token not found in cookies&quot;);&#10;            }&#10;            String userDetails = authenticationService.getUserDetails(token);&#10;&#10;            return ResponseEntity.ok(userDetails);&#10;        } catch (SecurityException | IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(e.getMessage());&#10;        } catch (Exception e) {&#10;            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(&quot;Failed to fetch user details&quot;);&#10;        }&#10;    }&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.controllers;&#10;&#10;import com.learning.backend.authentication.models.UserInfo;&#10;import com.learning.backend.authentication.services.AuthenticationService;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.http.HttpStatus;&#10;&#10;import jakarta.servlet.http.HttpServletResponse;&#10;import jakarta.servlet.http.Cookie;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/auth&quot;)&#10;public class AuthenticationController {&#10;&#10;    @Autowired&#10;    private AuthenticationService authenticationService;&#10;&#10;    @PutMapping(&quot;/signup&quot;)&#10;    public ResponseEntity&lt;String&gt; signup(@RequestBody UserInfo userInfo) {&#10;        try {&#10;            authenticationService.signup(userInfo);&#10;            return ResponseEntity.status(HttpStatus.CREATED).body(&quot;Signup successful&quot;);&#10;        } catch (IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(e.getMessage());&#10;        } catch (Exception e) {&#10;            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(e.getMessage()+&quot;\nSignup failed&quot;);&#10;        }&#10;    }&#10;&#10;    @PostMapping(&quot;/login&quot;)&#10;    public ResponseEntity&lt;String&gt; login(@RequestBody UserInfo userInfo, HttpServletResponse response) {&#10;        try {&#10;            String token = authenticationService.login(userInfo);&#10;            response.setHeader(&quot;Authorization&quot;, &quot;Bearer &quot; + token);&#10;            Cookie cookie = new Cookie(&quot;token&quot;, token);&#10;            cookie.setHttpOnly(true);&#10;            cookie.setPath(&quot;/&quot;);&#10;            // Uncomment the next line if your app uses HTTPS&#10;            // cookie.setSecure(true);&#10;            response.addCookie(cookie);&#10;            return ResponseEntity.ok(&quot;Login successful&quot;);&#10;        } catch (SecurityException | IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(e.getMessage());&#10;        } catch (Exception e) {&#10;            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(&quot;Login failed&quot;);&#10;        }&#10;    }&#10;&#10;    @GetMapping(&quot;/getUserDetails&quot;)&#10;    public ResponseEntity&lt;String&gt; getUserDetails(HttpServletRequest request) {&#10;        try {&#10;            String token = null;&#10;            Cookie[] cookies = request.getCookies();&#10;            if (cookies != null) {&#10;                for (Cookie cookie : cookies) {&#10;                    if (&quot;token&quot;.equals(cookie.getName())) {&#10;                        token = cookie.getValue();&#10;                        break;&#10;                    }&#10;                }&#10;            }&#10;            if (token == null || token.isEmpty()) {&#10;                return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(&quot;Token not found in cookies&quot;);&#10;            }&#10;            String userDetails = authenticationService.getUserDetails(token);&#10;&#10;            return ResponseEntity.ok(userDetails);&#10;        } catch (SecurityException | IllegalArgumentException e) {&#10;            return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(e.getMessage());&#10;        } catch (Exception e) {&#10;            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(&quot;Failed to fetch user details&quot;);&#10;        }&#10;    }&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/dto/CustomGrantedAuthority.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/dto/CustomGrantedAuthority.java" />
              <option name="originalContent" value="package com.learning.project.authentication.dto;&#10;&#10;import lombok.Setter;&#10;import org.springframework.security.core.GrantedAuthority;&#10;&#10;@Setter&#10;public class CustomGrantedAuthority implements GrantedAuthority {&#10;&#10;    private String authority;&#10;    @Override&#10;    public String getAuthority() {&#10;        if (authority != null &amp;&amp; !authority.startsWith(&quot;ROLE_&quot;)) {&#10;            return &quot;ROLE_&quot; + authority;&#10;        }&#10;        return authority;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.dto;&#13;&#10;&#13;&#10;import lombok.Setter;&#13;&#10;import org.springframework.security.core.GrantedAuthority;&#13;&#10;&#13;&#10;@Setter&#13;&#10;public class CustomGrantedAuthority implements GrantedAuthority {&#13;&#10;&#13;&#10;    private String authority;&#13;&#10;    @Override&#13;&#10;    public String getAuthority() {&#13;&#10;        if (authority != null &amp;&amp; !authority.startsWith(&quot;ROLE_&quot;)) {&#13;&#10;            return &quot;ROLE_&quot; + authority;&#13;&#10;        }&#13;&#10;        return authority;&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/dto/CustomUserDetails.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/dto/CustomUserDetails.java" />
              <option name="originalContent" value="package com.learning.project.authentication.dto;&#10;&#10;import lombok.Setter;&#10;import org.springframework.security.core.GrantedAuthority;&#10;import org.springframework.security.core.userdetails.UserDetails;&#10;&#10;import java.util.Collection;&#10;import java.util.List;&#10;&#10;@Setter&#10;public class CustomUserDetails implements UserDetails {&#10;&#10;    private String email;&#10;    private String password;&#10;    private List&lt;CustomGrantedAuthority&gt; authorities;&#10;    @Override&#10;    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {&#10;        return authorities;&#10;    }&#10;&#10;    @Override&#10;    public String getPassword() {&#10;        return password;&#10;    }&#10;&#10;    @Override&#10;    public String getUsername() {&#10;        return email;&#10;    }&#10;&#10;    @Override&#10;    public boolean isAccountNonExpired() {&#10;        return UserDetails.super.isAccountNonExpired();&#10;    }&#10;&#10;    @Override&#10;    public boolean isAccountNonLocked() {&#10;        return UserDetails.super.isAccountNonLocked();&#10;    }&#10;&#10;    @Override&#10;    public boolean isCredentialsNonExpired() {&#10;        return UserDetails.super.isCredentialsNonExpired();&#10;    }&#10;&#10;    @Override&#10;    public boolean isEnabled() {&#10;        return UserDetails.super.isEnabled();&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.dto;&#13;&#10;&#13;&#10;import lombok.Setter;&#13;&#10;import org.springframework.security.core.GrantedAuthority;&#13;&#10;import org.springframework.security.core.userdetails.UserDetails;&#13;&#10;&#13;&#10;import java.util.Collection;&#13;&#10;import java.util.List;&#13;&#10;&#13;&#10;@Setter&#13;&#10;public class CustomUserDetails implements UserDetails {&#13;&#10;&#13;&#10;    private String email;&#13;&#10;    private String password;&#13;&#10;    private List&lt;CustomGrantedAuthority&gt; authorities;&#13;&#10;    @Override&#13;&#10;    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {&#13;&#10;        return authorities;&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public String getPassword() {&#13;&#10;        return password;&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public String getUsername() {&#13;&#10;        return email;&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public boolean isAccountNonExpired() {&#13;&#10;        return UserDetails.super.isAccountNonExpired();&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public boolean isAccountNonLocked() {&#13;&#10;        return UserDetails.super.isAccountNonLocked();&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public boolean isCredentialsNonExpired() {&#13;&#10;        return UserDetails.super.isCredentialsNonExpired();&#13;&#10;    }&#13;&#10;&#13;&#10;    @Override&#13;&#10;    public boolean isEnabled() {&#13;&#10;        return UserDetails.super.isEnabled();&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/entities/BaseModel.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/entities/BaseModel.java" />
              <option name="originalContent" value="package com.learning.project.authentication.entities;&#10;&#10;import jakarta.persistence.GeneratedValue;&#10;import jakarta.persistence.GenerationType;&#10;import jakarta.persistence.Id;&#10;import jakarta.persistence.MappedSuperclass;&#10;import lombok.AllArgsConstructor;&#10;import lombok.Getter;&#10;import lombok.Setter;&#10;import org.springframework.data.jpa.repository.config.EnableJpaAuditing;&#10;&#10;import java.sql.Timestamp;&#10;&#10;@MappedSuperclass&#10;@AllArgsConstructor&#10;@Setter&#10;@Getter&#10;@EnableJpaAuditing&#10;public class BaseModel {&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    protected int id;&#10;&#10;    protected Timestamp createdAt;&#10;    protected Timestamp updatedAt;&#10;&#10;    public BaseModel() {&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.entities;&#13;&#10;&#13;&#10;import jakarta.persistence.GeneratedValue;&#13;&#10;import jakarta.persistence.GenerationType;&#13;&#10;import jakarta.persistence.Id;&#13;&#10;import jakarta.persistence.MappedSuperclass;&#13;&#10;import lombok.AllArgsConstructor;&#13;&#10;import lombok.Getter;&#13;&#10;import lombok.Setter;&#13;&#10;import org.springframework.data.jpa.repository.config.EnableJpaAuditing;&#13;&#10;&#13;&#10;import java.sql.Timestamp;&#13;&#10;&#13;&#10;@MappedSuperclass&#13;&#10;@AllArgsConstructor&#13;&#10;@Setter&#13;&#10;@Getter&#13;&#10;@EnableJpaAuditing&#13;&#10;public class BaseModel {&#13;&#10;    @Id&#13;&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#13;&#10;    protected int id;&#13;&#10;&#13;&#10;    protected Timestamp createdAt;&#13;&#10;    protected Timestamp updatedAt;&#13;&#10;&#13;&#10;    public BaseModel() {&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/entities/Role.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/entities/Role.java" />
              <option name="originalContent" value="package com.learning.project.authentication.entities;&#10;&#10;import jakarta.persistence.Entity;&#10;import jakarta.persistence.ManyToOne;&#10;import jakarta.persistence.JoinColumn;&#10;import lombok.Getter;&#10;import lombok.Setter;&#10;&#10;@Entity&#10;public class Role extends BaseModel {&#10;    @Getter&#10;    @Setter&#10;    private String roleName;&#10;&#10;    @ManyToOne&#10;    @JoinColumn(name = &quot;userid&quot;)&#10;    private User user;&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.entities;&#13;&#10;&#13;&#10;import jakarta.persistence.Entity;&#13;&#10;import jakarta.persistence.ManyToOne;&#13;&#10;import jakarta.persistence.JoinColumn;&#13;&#10;import lombok.Getter;&#13;&#10;import lombok.Setter;&#13;&#10;&#13;&#10;@Entity&#13;&#10;public class Role extends BaseModel {&#13;&#10;    @Getter&#13;&#10;    @Setter&#13;&#10;    private String roleName;&#13;&#10;&#13;&#10;    @ManyToOne&#13;&#10;    @JoinColumn(name = &quot;userid&quot;)&#13;&#10;    private User user;&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/entities/Session.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/entities/Session.java" />
              <option name="originalContent" value="package com.learning.project.authentication.entities;&#10;&#10;import jakarta.persistence.Column;&#10;import jakarta.persistence.Entity;&#10;import lombok.AllArgsConstructor;&#10;import lombok.Getter;&#10;import lombok.Setter;&#10;&#10;@Entity&#10;@Setter&#10;@Getter&#10;@AllArgsConstructor&#10;public class Session extends BaseModel{&#10;&#10;    @Column(length = 512)&#10;    private String sessionToken;&#10;    private int userId;&#10;    private String IPAddress;&#10;    private String deviceInfo;&#10;    private long expiresAt;&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.entities;&#13;&#10;&#13;&#10;import jakarta.persistence.Column;&#13;&#10;import jakarta.persistence.Entity;&#13;&#10;import lombok.AllArgsConstructor;&#13;&#10;import lombok.Getter;&#13;&#10;import lombok.Setter;&#13;&#10;&#13;&#10;@Entity&#13;&#10;@Setter&#13;&#10;@Getter&#13;&#10;@AllArgsConstructor&#13;&#10;public class Session extends BaseModel{&#13;&#10;&#13;&#10;    @Column(length = 512)&#13;&#10;    private String sessionToken;&#13;&#10;    private int userId;&#13;&#10;    private String IPAddress;&#13;&#10;    private String deviceInfo;&#13;&#10;    private long expiresAt;&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/entities/User.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/entities/User.java" />
              <option name="originalContent" value="package com.learning.project.authentication.entities;&#10;&#10;import jakarta.persistence.CascadeType;&#10;import jakarta.persistence.Entity;&#10;import jakarta.persistence.OneToMany;&#10;import lombok.Getter;&#10;import lombok.Setter;&#10;&#10;import java.util.List;&#10;&#10;@Entity&#10;@Getter&#10;@Setter&#10;public class User extends BaseModel {&#10;    private String username;&#10;    private String password;&#10;    private String email;&#10;    @OneToMany(cascade = CascadeType.ALL)&#10;    private List&lt;Role&gt; roles;&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.entities;&#13;&#10;&#13;&#10;import jakarta.persistence.CascadeType;&#13;&#10;import jakarta.persistence.Entity;&#13;&#10;import jakarta.persistence.OneToMany;&#13;&#10;import lombok.Getter;&#13;&#10;import lombok.Setter;&#13;&#10;&#13;&#10;import java.util.List;&#13;&#10;&#13;&#10;@Entity&#13;&#10;@Getter&#13;&#10;@Setter&#13;&#10;public class User extends BaseModel {&#13;&#10;    private String username;&#13;&#10;    private String password;&#13;&#10;    private String email;&#13;&#10;    @OneToMany(cascade = CascadeType.ALL)&#13;&#10;    private List&lt;Role&gt; roles;&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/models/UserInfo.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/models/UserInfo.java" />
              <option name="originalContent" value="package com.learning.project.authentication.models;&#10;&#10;import com.learning.project.authentication.entities.Role;&#10;import lombok.Getter;&#10;import lombok.Setter;&#10;&#10;import java.util.List;&#10;&#10;@Setter&#10;@Getter&#10;public class UserInfo {&#10;    private String email;&#10;    private String password;&#10;    private String userName;&#10;    private String deviceInfo;&#10;    private String IPAddress;&#10;    private int userId;&#10;    private List&lt;Role&gt; roles;&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.models;&#13;&#10;&#13;&#10;import com.learning.project.authentication.entities.Role;&#13;&#10;import lombok.Getter;&#13;&#10;import lombok.Setter;&#13;&#10;&#13;&#10;import java.util.List;&#13;&#10;&#13;&#10;@Setter&#13;&#10;@Getter&#13;&#10;public class UserInfo {&#13;&#10;    private String email;&#13;&#10;    private String password;&#13;&#10;    private String userName;&#13;&#10;    private String deviceInfo;&#13;&#10;    private String IPAddress;&#13;&#10;    private int userId;&#13;&#10;    private List&lt;Role&gt; roles;&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/repository/RoleRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/repository/RoleRepository.java" />
              <option name="originalContent" value="package com.learning.project.authentication.repository;&#10;&#10;import com.learning.project.authentication.entities.Role;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;&#10;public interface RoleRepository extends JpaRepository&lt;Role, Long&gt; {&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.repository;&#13;&#10;&#13;&#10;import com.learning.project.authentication.entities.Role;&#13;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#13;&#10;&#13;&#10;public interface RoleRepository extends JpaRepository&lt;Role, Long&gt; {&#13;&#10;&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/repository/SessionRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/repository/SessionRepository.java" />
              <option name="originalContent" value="package com.learning.project.authentication.repository;&#10;&#10;import com.learning.project.authentication.entities.Session;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;&#10;public interface SessionRepository extends JpaRepository&lt;Session, Long&gt; {&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.repository;&#13;&#10;&#13;&#10;import com.learning.project.authentication.entities.Session;&#13;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#13;&#10;&#13;&#10;public interface SessionRepository extends JpaRepository&lt;Session, Long&gt; {&#13;&#10;&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/repository/UserRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/repository/UserRepository.java" />
              <option name="originalContent" value="package com.learning.project.authentication.repository;&#10;&#10;import com.learning.project.authentication.entities.User;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;&#10;public interface UserRepository extends JpaRepository&lt;User, Long&gt; {&#10;    User findByEmail(String email);&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.repository;&#13;&#10;&#13;&#10;import com.learning.project.authentication.entities.User;&#13;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#13;&#10;&#13;&#10;public interface UserRepository extends JpaRepository&lt;User, Long&gt; {&#13;&#10;    User findByEmail(String email);&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/services/AESEncyptionService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/services/AESEncyptionService.java" />
              <option name="originalContent" value="package com.learning.project.authentication.services;&#10;&#10;import javax.crypto.Cipher;&#10;import javax.crypto.KeyGenerator;&#10;import javax.crypto.SecretKey;&#10;import java.util.Base64;&#10;&#10;public class AESEncyptionService {&#10;&#10;    // Encrypt a string using AES&#10;    public static String encrypt(String data, SecretKey key) throws Exception {&#10;        Cipher cipher = Cipher.getInstance(&quot;AES&quot;);&#10;        cipher.init(Cipher.ENCRYPT_MODE, key);&#10;        byte[] encryptedBytes = cipher.doFinal(data.getBytes());&#10;        return Base64.getEncoder().encodeToString(encryptedBytes);&#10;    }&#10;&#10;    // Decrypt a string using AES&#10;    public static String decrypt(String encryptedData, SecretKey key) throws Exception {&#10;        Cipher cipher = Cipher.getInstance(&quot;AES&quot;);&#10;        cipher.init(Cipher.DECRYPT_MODE, key);&#10;        byte[] decryptedBytes = cipher.doFinal(Base64.getDecoder().decode(encryptedData));&#10;        return new String(decryptedBytes);&#10;    }&#10;&#10;    public static void main(String[] args) throws Exception {&#10;        // Generate AES key&#10;        KeyGenerator keyGen = KeyGenerator.getInstance(&quot;AES&quot;);&#10;        keyGen.init(128); // 128-bit AES&#10;        SecretKey secretKey = keyGen.generateKey();&#10;&#10;        String originalText = &quot;Hello, secure world!&quot;;&#10;        String encryptedText = encrypt(originalText, secretKey);&#10;        String decryptedText = decrypt(encryptedText, secretKey);&#10;&#10;        System.out.println(&quot;Original: &quot; + originalText);&#10;        System.out.println(&quot;Encrypted: &quot; + encryptedText);&#10;        System.out.println(&quot;Decrypted: &quot; + decryptedText);&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.learning.backend.authentication.services;&#13;&#10;&#13;&#10;import javax.crypto.Cipher;&#13;&#10;import javax.crypto.KeyGenerator;&#13;&#10;import javax.crypto.SecretKey;&#13;&#10;import java.util.Base64;&#13;&#10;&#13;&#10;public class AESEncyptionService {&#13;&#10;&#13;&#10;    // Encrypt a string using AES&#13;&#10;    public static String encrypt(String data, SecretKey key) throws Exception {&#13;&#10;        Cipher cipher = Cipher.getInstance(&quot;AES&quot;);&#13;&#10;        cipher.init(Cipher.ENCRYPT_MODE, key);&#13;&#10;        byte[] encryptedBytes = cipher.doFinal(data.getBytes());&#13;&#10;        return Base64.getEncoder().encodeToString(encryptedBytes);&#13;&#10;    }&#13;&#10;&#13;&#10;    // Decrypt a string using AES&#13;&#10;    public static String decrypt(String encryptedData, SecretKey key) throws Exception {&#13;&#10;        Cipher cipher = Cipher.getInstance(&quot;AES&quot;);&#13;&#10;        cipher.init(Cipher.DECRYPT_MODE, key);&#13;&#10;        byte[] decryptedBytes = cipher.doFinal(Base64.getDecoder().decode(encryptedData));&#13;&#10;        return new String(decryptedBytes);&#13;&#10;    }&#13;&#10;&#13;&#10;    public static void main(String[] args) throws Exception {&#13;&#10;        // Generate AES key&#13;&#10;        KeyGenerator keyGen = KeyGenerator.getInstance(&quot;AES&quot;);&#13;&#10;        keyGen.init(128); // 128-bit AES&#13;&#10;        SecretKey secretKey = keyGen.generateKey();&#13;&#10;&#13;&#10;        String originalText = &quot;Hello, secure world!&quot;;&#13;&#10;        String encryptedText = encrypt(originalText, secretKey);&#13;&#10;        String decryptedText = decrypt(encryptedText, secretKey);&#13;&#10;&#13;&#10;        System.out.println(&quot;Original: &quot; + originalText);&#13;&#10;        System.out.println(&quot;Encrypted: &quot; + encryptedText);&#13;&#10;        System.out.println(&quot;Decrypted: &quot; + decryptedText);&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/services/AuthenticationService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/services/AuthenticationService.java" />
              <option name="originalContent" value="package com.learning.project.authentication.services;&#10;&#10;import com.learning.project.authentication.entities.Role;&#10;import com.learning.project.authentication.entities.Session;&#10;import com.learning.project.authentication.entities.User;&#10;import com.learning.project.authentication.models.UserInfo;&#10;import com.learning.project.authentication.repository.RoleRepository;&#10;import com.learning.project.authentication.repository.SessionRepository;&#10;import com.learning.project.authentication.repository.UserRepository;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;import org.springframework.stereotype.Service;&#10;&#10;import javax.crypto.KeyGenerator;&#10;import javax.crypto.SecretKey;&#10;import javax.crypto.spec.SecretKeySpec;&#10;import java.security.NoSuchAlgorithmException;&#10;import java.time.LocalDateTime;&#10;import java.time.ZoneOffset;&#10;import java.time.temporal.TemporalAmount;&#10;import java.util.Arrays;&#10;import java.util.Base64;&#10;import java.util.List;&#10;&#10;import static com.learning.project.authentication.services.AESEncyptionService.encrypt;&#10;import static java.time.temporal.ChronoUnit.MONTHS;&#10;&#10;@Service&#10;public class AuthenticationService {&#10;&#10;    @Autowired&#10;    private UserRepository userRepository;&#10;&#10;    @Autowired&#10;    private SessionRepository sessionRepository;&#10;&#10;    @Autowired&#10;    private RoleRepository roleRepository;&#10;&#10;    @Autowired&#10;    private PasswordEncoder passwordEncoder;&#10;&#10;    private String algorithm = &quot;AES&quot;;&#10;    // Static base64-encoded key (must be 16 bytes for AES-128)&#10;    private static final String STATIC_KEY_BASE64 = &quot;MTIzNDU2Nzg5MGFiY2RlZg==&quot;; // &quot;mySuperSecretKey123&quot; in base64&#10;    private final SecretKey secretKey = new SecretKeySpec(Base64.getDecoder().decode(STATIC_KEY_BASE64), algorithm);&#10;&#10;    public AuthenticationService() {&#10;    }&#10;&#10;    public void signup(UserInfo userInfo) {&#10;        if(userInfo.getUserName()==null || userInfo.getPassword()==null || userInfo.getEmail()==null) {&#10;            throw new RuntimeException(&quot;Invalid data&quot;);&#10;        }&#10;       if(isAlreadyRegistered(userInfo)) {&#10;           throw new RuntimeException(&quot;User already registered&quot;);&#10;       }&#10;       User user = prepareUserEntity(userInfo);&#10;       List&lt;Role&gt; roles = createDefaultRolesForUser(user);&#10;        user.setRoles(roles);&#10;       userRepository.save(user);&#10;    }&#10;&#10;    private User prepareUserEntity(UserInfo userInfo) {&#10;        User user = new User();&#10;        user.setUsername(userInfo.getUserName());&#10;        user.setPassword(passwordEncoder.encode(userInfo.getPassword()));&#10;        user.setEmail(userInfo.getEmail());&#10;        return user;&#10;    }&#10;&#10;    private boolean isAlreadyRegistered(UserInfo userInfo) {&#10;        return userRepository.findByEmail(userInfo.getEmail()) != null;&#10;    }&#10;&#10;    public String login(UserInfo userInfo) {&#10;        User user = userRepository.findByEmail(userInfo.getEmail());&#10;        if(user == null || !passwordEncoder.matches(userInfo.getPassword(), user.getPassword())) {&#10;            throw new RuntimeException(&quot;Invalid credentials&quot;);&#10;        }&#10;        userInfo.setRoles(user.getRoles());&#10;        String token = createJWTToken(userInfo);&#10;        userInfo.setUserId(user.getId());&#10;        createSession(userInfo, token);&#10;        return token;&#10;&#10;    }&#10;&#10;    private String createJWTToken(UserInfo userInfo) {&#10;        StringBuilder authoritiesBuilder = new StringBuilder();&#10;        if (userInfo != null &amp;&amp; userInfo.getRoles() != null) {&#10;            for (Role role : userInfo.getRoles()) {&#10;                if (authoritiesBuilder.length() &gt; 0) authoritiesBuilder.append(&quot;,&quot;);&#10;                authoritiesBuilder.append(role.getRoleName());&#10;            }&#10;        }&#10;        String header = Base64.getEncoder().encodeToString( (&quot;{ \&quot;alg\&quot;: \&quot;&quot; + algorithm +&quot;\&quot; }&quot;).getBytes());&#10;        String payload = Base64.getEncoder().encodeToString( (&quot;{ \&quot;user\&quot;: \&quot;&quot; + userInfo.getUserName()  +&#10;                         &quot;\&quot;, \&quot;email\&quot;: \&quot;&quot; + userInfo.getEmail() +&#10;                         &quot;\&quot;, \&quot;authorities\&quot;: \&quot;&quot; + authoritiesBuilder.toString() + &quot;\&quot; }&quot;).getBytes());&#10;        String signature = null;&#10;        try {&#10;            signature = AESEncyptionService.encrypt(header+&quot;.&quot;+payload, secretKey);&#10;        } catch (Exception e) {&#10;            throw new RuntimeException(e);&#10;        }&#10;        return header + &quot;.&quot; + payload + &quot;.&quot; + signature;&#10;    }&#10;&#10;    public void assignRoleToUser(Long userId, Long roleId) {&#10;        // Logic to assign role to user&#10;    }&#10;&#10;    public void createSession(UserInfo userInfo, String token) {&#10;        sessionRepository.save(new Session(token, userInfo.getUserId(), userInfo.getIPAddress(),&#10;                userInfo.getDeviceInfo(), LocalDateTime.now().plus(1, MONTHS).toEpochSecond(ZoneOffset.of(&quot;+05:30&quot;))));&#10;    }&#10;&#10;    public void invalidateSession(Long sessionId) {&#10;        // Logic to invalidate a user session&#10;    }&#10;&#10;    public String getUserDetails(String token) {&#10;        String header = token.substring(0, token.indexOf(&quot;.&quot;));&#10;        String payload = token.substring(token.indexOf(&quot;.&quot;)+1, token.lastIndexOf(&quot;.&quot;));&#10;        String signature = token.substring(token.lastIndexOf(&quot;.&quot;)+1);&#10;        String expectedSignature = null;&#10;        try {&#10;            expectedSignature = encrypt(header+&quot;.&quot;+payload, secretKey);&#10;        } catch (Exception e) {&#10;            throw new RuntimeException(e);&#10;        }&#10;        if(expectedSignature.equals(signature)) {&#10;            return new String(Base64.getDecoder().decode(payload));&#10;        } else {&#10;            throw new RuntimeException(&quot;Invalid token&quot;);&#10;        }&#10;    }&#10;&#10;    public List&lt;Role&gt; createDefaultRolesForUser(User user) {&#10;        Role adminRole = new Role();&#10;        adminRole.setRoleName(&quot;ADMIN&quot;);&#10;&#10;        Role userRole = new Role();&#10;        userRole.setRoleName(&quot;USER&quot;);&#10;&#10;        Role guestRole = new Role();&#10;        guestRole.setRoleName(&quot;GUEST&quot;);&#10;        return Arrays.asList(adminRole, userRole, guestRole);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.services;&#13;&#10;&#13;&#10;import com.learning.backend.authentication.entities.Role;&#13;&#10;import com.learning.backend.authentication.entities.Session;&#13;&#10;import com.learning.backend.authentication.entities.User;&#13;&#10;import com.learning.backend.authentication.models.UserInfo;&#13;&#10;import com.learning.backend.authentication.repository.RoleRepository;&#13;&#10;import com.learning.backend.authentication.repository.SessionRepository;&#13;&#10;import com.learning.backend.authentication.repository.UserRepository;&#13;&#10;import org.springframework.beans.factory.annotation.Autowired;&#13;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#13;&#10;import org.springframework.stereotype.Service;&#13;&#10;&#13;&#10;import javax.crypto.KeyGenerator;&#13;&#10;import javax.crypto.SecretKey;&#13;&#10;import javax.crypto.spec.SecretKeySpec;&#13;&#10;import java.security.NoSuchAlgorithmException;&#13;&#10;import java.time.LocalDateTime;&#13;&#10;import java.time.ZoneOffset;&#13;&#10;import java.time.temporal.TemporalAmount;&#13;&#10;import java.util.Arrays;&#13;&#10;import java.util.Base64;&#13;&#10;import java.util.List;&#13;&#10;&#13;&#10;import static com.learning.backend.authentication.services.AESEncyptionService.encrypt;&#13;&#10;import static java.time.temporal.ChronoUnit.MONTHS;&#13;&#10;&#13;&#10;@Service&#13;&#10;public class AuthenticationService {&#13;&#10;&#13;&#10;    @Autowired&#13;&#10;    private UserRepository userRepository;&#13;&#10;&#13;&#10;    @Autowired&#13;&#10;    private SessionRepository sessionRepository;&#13;&#10;&#13;&#10;    @Autowired&#13;&#10;    private RoleRepository roleRepository;&#13;&#10;&#13;&#10;    @Autowired&#13;&#10;    private PasswordEncoder passwordEncoder;&#13;&#10;&#13;&#10;    private String algorithm = &quot;AES&quot;;&#13;&#10;    // Static base64-encoded key (must be 16 bytes for AES-128)&#13;&#10;    private static final String STATIC_KEY_BASE64 = &quot;MTIzNDU2Nzg5MGFiY2RlZg==&quot;; // &quot;mySuperSecretKey123&quot; in base64&#13;&#10;    private final SecretKey secretKey = new SecretKeySpec(Base64.getDecoder().decode(STATIC_KEY_BASE64), algorithm);&#13;&#10;&#13;&#10;    public AuthenticationService() {&#13;&#10;    }&#13;&#10;&#13;&#10;    public void signup(UserInfo userInfo) {&#13;&#10;        if(userInfo.getUserName()==null || userInfo.getPassword()==null || userInfo.getEmail()==null) {&#13;&#10;            throw new RuntimeException(&quot;Invalid data&quot;);&#13;&#10;        }&#13;&#10;       if(isAlreadyRegistered(userInfo)) {&#13;&#10;           throw new RuntimeException(&quot;User already registered&quot;);&#13;&#10;       }&#13;&#10;       User user = prepareUserEntity(userInfo);&#13;&#10;       List&lt;Role&gt; roles = createDefaultRolesForUser(user);&#13;&#10;        user.setRoles(roles);&#13;&#10;       userRepository.save(user);&#13;&#10;    }&#13;&#10;&#13;&#10;    private User prepareUserEntity(UserInfo userInfo) {&#13;&#10;        User user = new User();&#13;&#10;        user.setUsername(userInfo.getUserName());&#13;&#10;        user.setPassword(passwordEncoder.encode(userInfo.getPassword()));&#13;&#10;        user.setEmail(userInfo.getEmail());&#13;&#10;        return user;&#13;&#10;    }&#13;&#10;&#13;&#10;    private boolean isAlreadyRegistered(UserInfo userInfo) {&#13;&#10;        return userRepository.findByEmail(userInfo.getEmail()) != null;&#13;&#10;    }&#13;&#10;&#13;&#10;    public String login(UserInfo userInfo) {&#13;&#10;        User user = userRepository.findByEmail(userInfo.getEmail());&#13;&#10;        if(user == null || !passwordEncoder.matches(userInfo.getPassword(), user.getPassword())) {&#13;&#10;            throw new RuntimeException(&quot;Invalid credentials&quot;);&#13;&#10;        }&#13;&#10;        userInfo.setRoles(user.getRoles());&#13;&#10;        String token = createJWTToken(userInfo);&#13;&#10;        userInfo.setUserId(user.getId());&#13;&#10;        createSession(userInfo, token);&#13;&#10;        return token;&#13;&#10;&#13;&#10;    }&#13;&#10;&#13;&#10;    private String createJWTToken(UserInfo userInfo) {&#13;&#10;        StringBuilder authoritiesBuilder = new StringBuilder();&#13;&#10;        if (userInfo != null &amp;&amp; userInfo.getRoles() != null) {&#13;&#10;            for (Role role : userInfo.getRoles()) {&#13;&#10;                if (authoritiesBuilder.length() &gt; 0) authoritiesBuilder.append(&quot;,&quot;);&#13;&#10;                authoritiesBuilder.append(role.getRoleName());&#13;&#10;            }&#13;&#10;        }&#13;&#10;        String header = Base64.getEncoder().encodeToString( (&quot;{ \&quot;alg\&quot;: \&quot;&quot; + algorithm +&quot;\&quot; }&quot;).getBytes());&#13;&#10;        String payload = Base64.getEncoder().encodeToString( (&quot;{ \&quot;user\&quot;: \&quot;&quot; + userInfo.getUserName()  +&#13;&#10;                         &quot;\&quot;, \&quot;email\&quot;: \&quot;&quot; + userInfo.getEmail() +&#13;&#10;                         &quot;\&quot;, \&quot;authorities\&quot;: \&quot;&quot; + authoritiesBuilder.toString() + &quot;\&quot; }&quot;).getBytes());&#13;&#10;        String signature = null;&#13;&#10;        try {&#13;&#10;            signature = AESEncyptionService.encrypt(header+&quot;.&quot;+payload, secretKey);&#13;&#10;        } catch (Exception e) {&#13;&#10;            throw new RuntimeException(e);&#13;&#10;        }&#13;&#10;        return header + &quot;.&quot; + payload + &quot;.&quot; + signature;&#13;&#10;    }&#13;&#10;&#13;&#10;    public void assignRoleToUser(Long userId, Long roleId) {&#13;&#10;        // Logic to assign role to user&#13;&#10;    }&#13;&#10;&#13;&#10;    public void createSession(UserInfo userInfo, String token) {&#13;&#10;        sessionRepository.save(new Session(token, userInfo.getUserId(), userInfo.getIPAddress(),&#13;&#10;                userInfo.getDeviceInfo(), LocalDateTime.now().plus(1, MONTHS).toEpochSecond(ZoneOffset.of(&quot;+05:30&quot;))));&#13;&#10;    }&#13;&#10;&#13;&#10;    public void invalidateSession(Long sessionId) {&#13;&#10;        // Logic to invalidate a user session&#13;&#10;    }&#13;&#10;&#13;&#10;    public String getUserDetails(String token) {&#13;&#10;        String header = token.substring(0, token.indexOf(&quot;.&quot;));&#13;&#10;        String payload = token.substring(token.indexOf(&quot;.&quot;)+1, token.lastIndexOf(&quot;.&quot;));&#13;&#10;        String signature = token.substring(token.lastIndexOf(&quot;.&quot;)+1);&#13;&#10;        String expectedSignature = null;&#13;&#10;        try {&#13;&#10;            expectedSignature = encrypt(header+&quot;.&quot;+payload, secretKey);&#13;&#10;        } catch (Exception e) {&#13;&#10;            throw new RuntimeException(e);&#13;&#10;        }&#13;&#10;        if(expectedSignature.equals(signature)) {&#13;&#10;            return new String(Base64.getDecoder().decode(payload));&#13;&#10;        } else {&#13;&#10;            throw new RuntimeException(&quot;Invalid token&quot;);&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    public List&lt;Role&gt; createDefaultRolesForUser(User user) {&#13;&#10;        Role adminRole = new Role();&#13;&#10;        adminRole.setRoleName(&quot;ADMIN&quot;);&#13;&#10;&#13;&#10;        Role userRole = new Role();&#13;&#10;        userRole.setRoleName(&quot;USER&quot;);&#13;&#10;&#13;&#10;        Role guestRole = new Role();&#13;&#10;        guestRole.setRoleName(&quot;GUEST&quot;);&#13;&#10;        return Arrays.asList(adminRole, userRole, guestRole);&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/services/CustomUserDetailsService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/authentication/services/CustomUserDetailsService.java" />
              <option name="originalContent" value="package com.learning.project.authentication.services;&#10;&#10;import com.learning.project.authentication.dto.CustomGrantedAuthority;&#10;import com.learning.project.authentication.dto.CustomUserDetails;&#10;import com.learning.project.authentication.entities.Role;&#10;import com.learning.project.authentication.entities.User;&#10;import com.learning.project.authentication.repository.UserRepository;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.security.core.userdetails.UserDetails;&#10;import org.springframework.security.core.userdetails.UserDetailsService;&#10;import org.springframework.security.core.userdetails.UsernameNotFoundException;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.util.List;&#10;&#10;public class CustomUserDetailsService implements UserDetailsService {&#10;&#10;    @Autowired&#10;    private UserRepository userRepository;&#10;&#10;    @Override&#10;    @Transactional(readOnly = true)&#10;    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {&#10;        User user = userRepository.findByEmail(username);&#10;        CustomUserDetails customUserDetails;&#10;        if(user!=null) {&#10;            customUserDetails = new CustomUserDetails();&#10;            customUserDetails.setEmail(user.getEmail());&#10;            customUserDetails.setPassword(user.getPassword());&#10;            // Set roles/authorities if needed&#10;            List&lt;Role&gt; roles = user.getRoles();&#10;            List&lt;CustomGrantedAuthority&gt; authorities = roles.stream()&#10;                    .map(role -&gt; {&#10;                        CustomGrantedAuthority authority = new CustomGrantedAuthority();&#10;                        authority.setAuthority(role.getRoleName());&#10;                        return authority;&#10;                    })&#10;                    .toList();&#10;            customUserDetails.setAuthorities(authorities);&#10;            return customUserDetails;&#10;        } else {&#10;            throw new UsernameNotFoundException(&quot;User not found with email: &quot; + username);&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend.authentication.services;&#13;&#10;&#13;&#10;import com.learning.project.authentication.dto.CustomGrantedAuthority;&#13;&#10;import com.learning.project.authentication.dto.CustomUserDetails;&#13;&#10;import com.learning.project.authentication.entities.Role;&#13;&#10;import com.learning.project.authentication.entities.User;&#13;&#10;import com.learning.project.authentication.repository.UserRepository;&#13;&#10;import org.springframework.beans.factory.annotation.Autowired;&#13;&#10;import org.springframework.security.core.userdetails.UserDetails;&#13;&#10;import org.springframework.security.core.userdetails.UserDetailsService;&#13;&#10;import org.springframework.security.core.userdetails.UsernameNotFoundException;&#13;&#10;import org.springframework.transaction.annotation.Transactional;&#13;&#10;&#13;&#10;import java.util.List;&#13;&#10;&#13;&#10;public class CustomUserDetailsService implements UserDetailsService {&#13;&#10;&#13;&#10;    @Autowired&#13;&#10;    private UserRepository userRepository;&#13;&#10;&#13;&#10;    @Override&#13;&#10;    @Transactional(readOnly = true)&#13;&#10;    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {&#13;&#10;        User user = userRepository.findByEmail(username);&#13;&#10;        CustomUserDetails customUserDetails;&#13;&#10;        if(user!=null) {&#13;&#10;            customUserDetails = new CustomUserDetails();&#13;&#10;            customUserDetails.setEmail(user.getEmail());&#13;&#10;            customUserDetails.setPassword(user.getPassword());&#13;&#10;            // Set roles/authorities if needed&#13;&#10;            List&lt;Role&gt; roles = user.getRoles();&#13;&#10;            List&lt;CustomGrantedAuthority&gt; authorities = roles.stream()&#13;&#10;                    .map(role -&gt; {&#13;&#10;                        CustomGrantedAuthority authority = new CustomGrantedAuthority();&#13;&#10;                        authority.setAuthority(role.getRoleName());&#13;&#10;                        return authority;&#13;&#10;                    })&#13;&#10;                    .toList();&#13;&#10;            customUserDetails.setAuthorities(authorities);&#13;&#10;            return customUserDetails;&#13;&#10;        } else {&#13;&#10;            throw new UsernameNotFoundException(&quot;User not found with email: &quot; + username);&#13;&#10;        }&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/learning/backend/config/SecurityConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/learning/backend/config/SecurityConfig.java" />
              <option name="originalContent" value="package com.learning.project.config;&#10;&#10;import com.learning.project.authentication.services.CustomUserDetailsService;&#10;import com.learning.project.authentication.services.JwtAuthenticationFilter;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.security.config.Customizer;&#10;import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;&#10;import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity;&#10;import org.springframework.security.config.annotation.web.builders.HttpSecurity;&#10;import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;&#10;import org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration;&#10;import org.springframework.security.config.http.SessionCreationPolicy;&#10;import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;import org.springframework.security.web.SecurityFilterChain;&#10;import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;&#10;&#10;@Configuration&#10;@EnableWebSecurity&#10;@EnableMethodSecurity&#10;public class SecurityConfig {&#10;&#10;    @Autowired&#10;    private JwtAuthenticationFilter jwtAuthenticationFilter;&#10;&#10;  //  @Bean&#10;    public CustomUserDetailsService userDetailsService() {&#10;        return new CustomUserDetailsService();&#10;    }&#10;&#10;    @Bean&#10;    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {&#10;        http&#10;                .csrf(csrf -&gt; csrf.disable())&#10;                .authorizeHttpRequests((authorize) -&gt; authorize&#10;                        .requestMatchers(&quot;/auth/signup&quot;, &quot;/auth/login&quot;, &quot;/login.html&quot;).permitAll()&#10;                        .anyRequest().authenticated()&#10;                )&#10;                .exceptionHandling(exception -&gt; exception&#10;                        .authenticationEntryPoint((request, response, authException) -&gt; {&#10;                            response.sendRedirect(&quot;/login.html&quot;);&#10;                        })&#10;                )&#10;                .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class)&#10;                .sessionManagement(session -&gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));&#10;        //   .httpBasic(Customizer.withDefaults())&#10;           //     .formLogin(Customizer.withDefaults());&#10;&#10;        return http.build();&#10;    }&#10;&#10;}" />
              <option name="updatedContent" value="package com.learning.backend.config;&#13;&#10;&#13;&#10;import com.learning.backend.authentication.services.CustomUserDetailsService;&#13;&#10;import com.learning.backend.authentication.services.JwtAuthenticationFilter;&#13;&#10;import org.springframework.beans.factory.annotation.Autowired;&#13;&#10;import org.springframework.context.annotation.Bean;&#13;&#10;import org.springframework.context.annotation.Configuration;&#13;&#10;import org.springframework.security.config.Customizer;&#13;&#10;import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;&#13;&#10;import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity;&#13;&#10;import org.springframework.security.config.annotation.web.builders.HttpSecurity;&#13;&#10;import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;&#13;&#10;import org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration;&#13;&#10;import org.springframework.security.config.http.SessionCreationPolicy;&#13;&#10;import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;&#13;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#13;&#10;import org.springframework.security.web.SecurityFilterChain;&#13;&#10;import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;&#13;&#10;&#13;&#10;@Configuration&#13;&#10;@EnableWebSecurity&#13;&#10;@EnableMethodSecurity&#13;&#10;public class SecurityConfig {&#13;&#10;&#13;&#10;    @Autowired&#13;&#10;    private JwtAuthenticationFilter jwtAuthenticationFilter;&#13;&#10;&#13;&#10;  //  @Bean&#13;&#10;    public CustomUserDetailsService userDetailsService() {&#13;&#10;        return new CustomUserDetailsService();&#13;&#10;    }&#13;&#10;&#13;&#10;    @Bean&#13;&#10;    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {&#13;&#10;        http&#13;&#10;                .csrf(csrf -&gt; csrf.disable())&#13;&#10;                .authorizeHttpRequests((authorize) -&gt; authorize&#13;&#10;                        .requestMatchers(&quot;/auth/signup&quot;, &quot;/auth/login&quot;, &quot;/login.html&quot;).permitAll()&#13;&#10;                        .anyRequest().authenticated()&#13;&#10;                )&#13;&#10;                .exceptionHandling(exception -&gt; exception&#13;&#10;                        .authenticationEntryPoint((request, response, authException) -&gt; {&#13;&#10;                            response.sendRedirect(&quot;/login.html&quot;);&#13;&#10;                        })&#13;&#10;                )&#13;&#10;                .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class)&#13;&#10;                .sessionManagement(session -&gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS));&#13;&#10;        //   .httpBasic(Customizer.withDefaults())&#13;&#10;           //     .formLogin(Customizer.withDefaults());&#13;&#10;&#13;&#10;        return http.build();&#13;&#10;    }&#13;&#10;&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/test/java/com/learning/project/ProjectApplicationTests.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/test/java/com/learning/project/ProjectApplicationTests.java" />
              <option name="originalContent" value="package com.learning.project;&#10;&#10;import org.junit.jupiter.api.Test;&#10;import org.springframework.boot.test.context.SpringBootTest;&#10;&#10;@SpringBootTest&#10;class ProjectApplicationTests {&#10;&#10;&#9;@Test&#10;&#9;void contextLoads() {&#10;&#9;}&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.learning.backend;&#10;&#10;import org.junit.jupiter.api.Test;&#10;import org.springframework.boot.test.context.SpringBootTest;&#10;&#10;@SpringBootTest&#10;class ProjectApplicationTests {&#10;&#10;&#9;@Test&#10;&#9;void contextLoads() {&#10;&#9;}&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>